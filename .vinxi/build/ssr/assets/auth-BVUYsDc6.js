import{j as a}from"./utils-AQpNWTN2.js";import{a as n}from"./jwt-CO0ye28h.js";function l(o){return async r=>{const s=r,t=s.request.headers.get("accept")==="text/event-stream",e=await n(s.request);return t?(e&&(s.locals||(s.locals={}),s.locals.user=e),o({...s,user:e||{userId:"anonymous",username:"anonymous"},locals:{...s.locals,user:e||{userId:"anonymous",username:"anonymous"}}})):e?(s.locals||(s.locals={}),s.locals.user=e,o({...s,user:e,locals:{...s.locals,user:e}})):(console.warn("[Auth] Unauthorized access attempt"),a({error:"Unauthorized"},401))}}export{l as w};
