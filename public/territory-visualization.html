<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Territory Control Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border: 1px solid #666;
        }
        #territory-map {
            width: 100%;
            height: 500px;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
        }
        .controls {
            margin: 20px 0;
            text-align: center;
        }
        button {
            padding: 8px 16px;
            margin: 0 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Territory Control Visualization</h1>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgba(255, 99, 71, 0.3); border-color: #ff6347;"></div>
                <span>Player 1 Territory</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgba(54, 162, 235, 0.3); border-color: #36a2eb;"></div>
                <span>Player 2 Territory</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgba(255, 255, 0, 0.3); border-color: #ff0;"></div>
                <span>Contested Area</span>
            </div>
        </div>

        <div class="controls">
            <button onclick="addBasePoint('player1')">Add P1 Base</button>
            <button onclick="addBasePoint('player2')">Add P2 Base</button>
            <button onclick="resetMap()">Reset</button>
        </div>

        <svg id="territory-map" viewBox="-150 -150 300 300">
            <!-- Grid -->
            <defs>
                <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                    <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#eee" stroke-width="0.5"/>
                </pattern>
            </defs>
            <rect width="100%" height="100%" fill="url(#grid)" />
            
            <!-- Origin -->
            <circle cx="0" cy="0" r="3" fill="gold" stroke="#333" stroke-width="1" />
            <text x="5" y="5" font-size="5" fill="#333">(0,0)</text>
            
            <!-- Territories will be added here by JavaScript -->
            <g id="territories"></g>
            
            <!-- Base points will be added here by JavaScript -->
            <g id="base-points"></g>
            
            <!-- Influence lines will be added here by JavaScript -->
            <g id="influence-lines"></g>
        </svg>
    </div>

    <script>
        const svg = document.getElementById('territory-map');
        const territoriesGroup = document.getElementById('territories');
        const basePointsGroup = document.getElementById('base-points');
        const influenceLinesGroup = document.getElementById('influence-lines');
        
        let basePoints = [];
        let territories = [];
        
        // Add initial base points
        addBasePoint('player1', -40, -40);
        addBasePoint('player1', 40, -40);
        addBasePoint('player2', 40, 40);
        addBasePoint('player2', -40, 40);
        
        // Update territories
        updateTerritories();
        
        function addBasePoint(player, x, y) {
            // If x,y not provided, add at a random position
            if (x === undefined || y === undefined) {
                x = Math.floor(Math.random() * 200 - 100);
                y = Math.floor(Math.random() * 200 - 100);
            }
            
            const id = 'bp' + Date.now();
            const point = { id, player, x, y };
            basePoints.push(point);
            
            // Add visual representation
            const pointEl = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            pointEl.setAttribute('cx', x);
            pointEl.setAttribute('cy', y);
            pointEl.setAttribute('r', 4);
            pointEl.setAttribute('fill', player === 'player1' ? '#ff6347' : '#36a2eb');
            pointEl.setAttribute('stroke', '#333');
            pointEl.setAttribute('stroke-width', '1');
            pointEl.setAttribute('data-id', id);
            basePointsGroup.appendChild(pointEl);
            
            // Update territories
            updateTerritories();
        }
        
        function updateTerritories() {
            // Clear existing territories and lines
            territoriesGroup.innerHTML = '';
            influenceLinesGroup.innerHTML = '';
            
            // Draw influence lines
            basePoints.forEach(point => {
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', point.x);
                line.setAttribute('y1', point.y);
                line.setAttribute('x2', 0);
                line.setAttribute('y2', 0);
                line.setAttribute('stroke', point.player === 'player1' ? 'rgba(255, 99, 71, 0.5)' : 'rgba(54, 162, 235, 0.5)');
                line.setAttribute('stroke-width', '1');
                influenceLinesGroup.appendChild(line);
            });
            
            // Simple territory visualization (simplified for demo)
            const territory1 = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            territory1.setAttribute('points', '-150,-150 -150,0 -75,0 0,-75 0,-150');
            territory1.setAttribute('fill', 'rgba(255, 99, 71, 0.3)');
            territory1.setAttribute('stroke', '#ff6347');
            territory1.setAttribute('stroke-width', '0.5');
            territoriesGroup.appendChild(territory1);
            
            const territory2 = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            territory2.setAttribute('points', '150,150 150,0 75,0 0,75 0,150');
            territory2.setAttribute('fill', 'rgba(54, 162, 235, 0.3)');
            territory2.setAttribute('stroke', '#36a2eb');
            territory2.setAttribute('stroke-width', '0.5');
            territoriesGroup.appendChild(territory2);
            
            // Contested area
            const contested = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            contested.setAttribute('points', '-75,0 0,-75 75,0 0,75');
            contested.setAttribute('fill', 'rgba(255, 255, 0, 0.3)');
            contested.setAttribute('stroke', 'rgba(255, 200, 0, 0.7)');
            contested.setAttribute('stroke-width', '0.5');
            territoriesGroup.appendChild(contested);
        }
        
        function resetMap() {
            basePoints = [];
            basePointsGroup.innerHTML = '';
            updateTerritories();
        }
        
        // Make SVG pannable and zoomable
        let isPanning = false;
        let startPoint = { x: 0, y: 0 };
        let viewBox = { x: -150, y: -150, width: 300, height: 300 };
        let scale = 1;
        
        svg.addEventListener('mousedown', (e) => {
            isPanning = true;
            startPoint = { x: e.clientX, y: e.clientY };
        });
        
        svg.addEventListener('mousemove', (e) => {
            if (isPanning) {
                const dx = (e.clientX - startPoint.x) * viewBox.width / svg.clientWidth;
                const dy = (e.clientY - startPoint.y) * viewBox.height / svg.clientHeight;
                
                viewBox.x -= dx;
                viewBox.y -= dy;
                
                updateViewBox();
                startPoint = { x: e.clientX, y: e.clientY };
            }
        });
        
        svg.addEventListener('mouseup', () => {
            isPanning = false;
        });
        
        svg.addEventListener('mouseleave', () => {
            isPanning = false;
        });
        
        svg.addEventListener('wheel', (e) => {
            e.preventDefault();
            
            // Get mouse position relative to SVG
            const rect = svg.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;
            
            // Calculate mouse position in viewBox coordinates
            const mouseXvb = viewBox.x + (mouseX / svg.clientWidth) * viewBox.width;
            const mouseYvb = viewBox.y + (mouseY / svg.clientHeight) * viewBox.height;
            
            // Calculate zoom factor
            const delta = -e.deltaY;
            const zoomFactor = delta > 0 ? 1.1 : 0.9;
            
            // Update viewBox
            viewBox.width *= zoomFactor;
            viewBox.height *= zoomFactor;
            viewBox.x = mouseXvb - (mouseX / svg.clientWidth) * viewBox.width;
            viewBox.y = mouseYvb - (mouseY / svg.clientHeight) * viewBox.height;
            
            updateViewBox();
        });
        
        function updateViewBox() {
            svg.setAttribute('viewBox', `${viewBox.x} ${viewBox.y} ${viewBox.width} ${viewBox.height}`);
        }
    </script>
</body>
</html>
